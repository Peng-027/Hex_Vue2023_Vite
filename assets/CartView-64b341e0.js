import{_ as m,o as c,c as i,a as p,d as t,F as u,f as g,g as I,t as l,h as $,v as x}from"./index-2e77758c.js";const{VITE_APP_URL:n,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"peng-hex",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},f={data(){return{products:[],productId:"",cart:{},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){this.$http.get(`${n}/v2/api/${r}/cart`).then(e=>{this.cart=e.data.data})},updateCartItem(e){const a={data:{product_id:e.id,qty:e.qty}};this.loadingItem=e.id,this.$http.put(`${n}/v2/api/${r}/cart/${e.id}`,a).then(h=>{this.getCarts(),this.loadingItem=""}).catch(h=>{console.log(h)})},deleteItem(e){this.loadingItem=e.id,this.$http.delete(`${n}/v2/api/${r}/cart/${e.id}`).then(a=>{this.getCarts(),this.loadingItem=""})},deleteAll(e){this.loadingItem=e.id,this.$http.delete(`${n}/v2/api/${r}/carts`).then(a=>{this.getCarts(),this.loadingItem=""})},onSubmit(){const e=this.form;this.$http.post(`${n}/v2/api/${r}/order`,{data:e}).then(a=>{alert(a.data.message),this.getCarts(),this.$refs.form.resetForm()}).catch(a=>{alert(a.data.message)})}},mounted(){this.getCarts()}},v={class:"table align-middle"},C=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),b=["onClick","disabled"],y=t("div",{class:"text-success"}," 已套用優惠券 ",-1),P={class:"input-group input-group-sm"},V=["onUpdate:modelValue","onChange","disabled"],A=["value"],E={class:"text-end"},k=t("td",{colspan:"3",class:"text-end"},"總計",-1),T={class:"text-end"},D=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),U={class:"text-end text-success"};function q(e,a,h,B,d,_){return c(),i(u,null,[p(" 這是購物車頁面 "),t("table",v,[C,t("tbody",null,[d.cart.carts?(c(!0),i(u,{key:0},g(d.cart.carts,s=>(c(),i("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>_.deleteItem(s),disabled:d.loadingItem===s.id}," x ",8,b)]),t("td",null,[p(l(s.product.title)+" ",1),y]),t("td",null,[t("div",P,[$(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":o=>s.qty=o,onChange:o=>_.updateCartItem(s),disabled:d.loadingItem===s.id},[(c(),i(u,null,g(20,o=>t("option",{value:o,key:`${o}個購物車商品`},l(o),9,A)),64))],40,V),[[x,s.qty]])])]),t("td",E,l(s.total),1)]))),128)):I("",!0)]),t("tfoot",null,[t("tr",null,[k,t("td",T,l(d.cart.total),1)]),t("tr",null,[D,t("td",U,l(d.cart.final_total),1)])])])],64)}const R=m(f,[["render",q]]);export{R as default};
